
<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>แบบทดสอบความรู้ด้านอาหารและโภชนาการ</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Prompt', sans-serif;
            background-color: #f0f9f0;
            color: #333;
        }
        
        .btn-primary {
            background-color: #2ecc71;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            background-color: #27ae60;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .quiz-container {
            background: linear-gradient(145deg, #ffffff, #f0f9f0);
            box-shadow: 0 10px 30px rgba(46, 204, 113, 0.15);
        }
        
        .option-btn {
            background-color: white;
            border: 2px solid #e0e0e0;
            transition: all 0.2s ease;
        }
        
        .option-btn:hover {
            border-color: #2ecc71;
            background-color: #f0fff0;
        }
        
        .option-btn.selected {
            background-color: #2ecc71;
            color: white;
            border-color: #2ecc71;
        }
        
        .progress-bar {
            height: 8px;
            background-color: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background-color: #2ecc71;
            transition: width 0.3s ease;
        }
        
        .timer-bar {
            height: 8px;
            background-color: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .timer-fill {
            height: 100%;
            background-color: #2ecc71;
            transition: width 0.1s linear;
        }
        
        .result-card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(46, 204, 113, 0.15);
            transition: all 0.3s ease;
        }
        
        .result-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(46, 204, 113, 0.2);
        }
        
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #2ecc71;
            animation: confetti-fall 3s ease-in-out infinite;
            z-index: 1;
        }
        
        @keyframes confetti-fall {
            0% {
                transform: translateY(-100px) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
            100% {
                transform: scale(1);
            }
        }
    </style>
</head>
<body class="min-h-screen">
    <!-- Welcome Screen -->
    <div id="welcome-screen" class="container mx-auto px-4 py-10 max-w-4xl">
        <div class="quiz-container rounded-3xl p-8 text-center">
            <div class="flex justify-center mb-6">
                <svg class="w-20 h-20 text-green-500" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M6 3a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm.293 7.707a1 1 0 010-1.414L8.586 7H5a1 1 0 110-2h5a1 1 0 01.707.293l3 3a1 1 0 010 1.414l-3 3A1 1 0 0110 13H5a1 1 0 110-2h3.586l-2.293-2.293z" clip-rule="evenodd"></path>
                </svg>
            </div>
            <h1 class="text-3xl font-bold text-green-600 mb-4">แบบทดสอบความรู้ด้านอาหารและโภชนาการ</h1>
            <p class="text-lg mb-6 text-gray-600">สำหรับกลุ่มวัยทำงาน (Post-Test)</p>
            <div class="bg-green-50 p-4 rounded-lg mb-6">
                <h2 class="font-semibold text-green-700 mb-2">คำแนะนำ</h2>
                <ul class="text-left text-gray-700 space-y-2">
                    <li class="flex items-center"><i class="fas fa-check-circle text-green-500 mr-2"></i> แบบทดสอบมีทั้งหมด 20 ข้อ</li>
                    <li class="flex items-center"><i class="fas fa-clock text-green-500 mr-2"></i> มีเวลาทำข้อละ 2 นาที</li>
                    <li class="flex items-center"><i class="fas fa-random text-green-500 mr-2"></i> คำถามและตัวเลือกจะถูกสุ่มลำดับ</li>
                    <li class="flex items-center"><i class="fas fa-trophy text-green-500 mr-2"></i> เมื่อทำเสร็จจะมีสรุปคะแนน</li>
                </ul>
            </div>
            <div class="mb-6">
                <label for="player-name" class="block text-gray-700 mb-2">กรุณาใส่ชื่อของคุณ</label>
                <input type="text" id="player-name" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="ชื่อ-นามสกุล">
            </div>
            <button id="start-btn" class="btn-primary px-8 py-3 rounded-full text-white font-semibold text-lg shadow-lg">
                <i class="fas fa-play-circle mr-2"></i> เริ่มทำแบบทดสอบ
            </button>
        </div>
    </div>

    <!-- Quiz Screen -->
    <div id="quiz-screen" class="container mx-auto px-4 py-6 max-w-4xl hidden">
        <div class="quiz-container rounded-3xl p-6 md:p-8">
            <!-- Header Info -->
            <div class="flex flex-col md:flex-row justify-between items-center mb-6">
                <div class="player-info mb-4 md:mb-0">
                    <div class="flex items-center">
                        <i class="fas fa-user-circle text-green-500 text-2xl mr-2"></i>
                        <span class="font-medium text-gray-700">ผู้ทำแบบทดสอบ: </span>
                        <span id="display-name" class="ml-2 font-semibold text-green-600"></span>
                    </div>
                </div>
                <div class="quiz-progress text-right">
                    <div class="flex items-center justify-end">
                        <i class="fas fa-tasks text-green-500 text-xl mr-2"></i>
                        <span class="font-medium">ข้อที่: </span>
                        <span id="current-question" class="ml-1 font-semibold text-green-600">1</span>
                        <span class="mx-1">/</span>
                        <span id="total-questions" class="font-semibold text-green-600">20</span>
                    </div>
                    <div class="flex items-center justify-end mt-1">
                        <i class="fas fa-check-circle text-green-500 text-xl mr-2"></i>
                        <span class="font-medium">คะแนน: </span>
                        <span id="current-score" class="ml-1 font-semibold text-green-600">0</span>
                    </div>
                </div>
            </div>
            
            <!-- Progress Bar -->
            <div class="progress-bar mb-4">
                <div class="progress-fill" style="width: 5%"></div>
            </div>
            
            <!-- Timer -->
            <div class="flex items-center mb-2">
                <i class="fas fa-hourglass-half text-green-500 mr-2"></i>
                <span class="font-medium">เวลาที่เหลือ: </span>
                <span id="timer" class="ml-1 font-semibold text-green-600">2:00</span>
            </div>
            <div class="timer-bar mb-6">
                <div class="timer-fill" style="width: 100%"></div>
            </div>
            
            <!-- Question -->
            <div class="bg-white rounded-xl p-5 mb-6 shadow-sm">
                <h2 id="question-text" class="text-xl font-semibold text-gray-800 mb-1"></h2>
                <p id="question-detail" class="text-gray-600 text-sm"></p>
            </div>
            
            <!-- Options -->
            <div id="options-container" class="grid grid-cols-1 gap-3 mb-6">
                <!-- Options will be inserted here -->
            </div>
            
            <!-- Navigation Buttons -->
            <div class="flex justify-between">
                <button id="prev-btn" class="btn-primary px-5 py-2 rounded-lg text-white font-medium flex items-center opacity-50 cursor-not-allowed" disabled>
                    <i class="fas fa-arrow-left mr-2"></i> ข้อก่อนหน้า
                </button>
                <button id="next-btn" class="btn-primary px-5 py-2 rounded-lg text-white font-medium flex items-center">
                    ข้อถัดไป <i class="fas fa-arrow-right ml-2"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Results Screen -->
    <div id="results-screen" class="container mx-auto px-4 py-10 max-w-4xl hidden">
        <div class="quiz-container rounded-3xl p-8 text-center relative overflow-hidden">
            <div id="confetti-container" class="absolute inset-0 overflow-hidden"></div>
            
            <div class="relative z-10">
                <div class="flex justify-center mb-6">
                    <div class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center">
                        <i class="fas fa-trophy text-4xl text-green-500"></i>
                    </div>
                </div>
                
                <h1 class="text-3xl font-bold text-green-600 mb-2">ผลการทดสอบ</h1>
                <p class="text-lg mb-6 text-gray-600">คุณได้ทำแบบทดสอบเสร็จสิ้นแล้ว!</p>
                
                <div class="result-card p-6 mb-8 pulse">
                    <div class="flex flex-col md:flex-row items-center justify-center">
                        <div class="text-center md:text-left md:mr-8">
                            <p class="text-gray-600 mb-1">ชื่อผู้ทำแบบทดสอบ</p>
                            <p id="result-name" class="text-xl font-semibold text-gray-800 mb-4"></p>
                            
                            <p class="text-gray-600 mb-1">คะแนนที่ได้</p>
                            <div class="flex items-center justify-center md:justify-start">
                                <span id="final-score" class="text-4xl font-bold text-green-600">0</span>
                                <span class="text-2xl text-gray-500 ml-1">/</span>
                                <span id="max-score" class="text-2xl text-gray-500">20</span>
                            </div>
                        </div>
                        
                        <div class="mt-6 md:mt-0 w-full md:w-auto">
                            <div class="w-32 h-32 mx-auto relative">
                                <svg class="w-full h-full" viewBox="0 0 36 36">
                                    <path class="circle-bg"
                                        d="M18 2.0845
                                        a 15.9155 15.9155 0 0 1 0 31.831
                                        a 15.9155 15.9155 0 0 1 0 -31.831"
                                        fill="none"
                                        stroke="#eee"
                                        stroke-width="3"
                                    />
                                    <path id="circle-progress"
                                        d="M18 2.0845
                                        a 15.9155 15.9155 0 0 1 0 31.831
                                        a 15.9155 15.9155 0 0 1 0 -31.831"
                                        fill="none"
                                        stroke="#2ecc71"
                                        stroke-width="3"
                                        stroke-dasharray="100, 100"
                                    />
                                    <text id="percentage" x="18" y="21" font-size="8" text-anchor="middle" fill="#2ecc71" font-weight="bold">0%</text>
                                </svg>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mb-8">
                    <h2 class="text-xl font-semibold text-green-600 mb-4">ผลการประเมิน</h2>
                    <div id="evaluation-message" class="bg-green-50 p-4 rounded-lg text-left"></div>
                </div>
                
                <button id="restart-btn" class="btn-primary px-8 py-3 rounded-full text-white font-semibold text-lg shadow-lg">
                    <i class="fas fa-redo-alt mr-2"></i> ทำแบบทดสอบอีกครั้ง
                </button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-green-800 text-white py-4 mt-10">
        <div class="container mx-auto px-4 text-center">
            <p>พัฒนาโดย JamesPakorn</p>
            <div class="flex justify-center mt-2 space-x-4">
                <a href="#" class="text-green-200 hover:text-white transition-colors">
                    <i class="fab fa-facebook"></i>
                </a>
                <a href="#" class="text-green-200 hover:text-white transition-colors">
                    <i class="fab fa-twitter"></i>
                </a>
                <a href="#" class="text-green-200 hover:text-white transition-colors">
                    <i class="fab fa-instagram"></i>
                </a>
            </div>
        </div>
    </footer>

    <script>
        // Quiz questions and answers
        const quizData = [
            {
                question: "นางสาวรติมา ใจชื่อ น้ำหนัก 80 ส่วนสูง 160 มีค่าดัชนีมวลกายเป็นเท่าไร",
                options: ["23.25", "25.25", "31.25", "33.25"],
                answer: "31.25"
            },
            {
                question: "นางสาวรติมา ใจชื่อ น้ำหนัก 80 ส่วนสูง 160 เมื่อแปลผลระดับดัชนีมวลกาย (BMI) อยู่ในระดับใด",
                options: ["ปกติ", "น้ำหนักเกิน", "อ้วนระดับ 1", "อ้วนระดับ 2"],
                answer: "อ้วนระดับ 1"
            },
            {
                question: "ผู้หญิงวัยทำงานต้องการพลังงาน (กิโลแคลอรี่) ประมาณเท่าไรต่อวัน",
                options: ["1400 กิโลแคลอรี่ต่อวัน", "1600 กิโลแคลอรี่ต่อวัน", "1800 กิโลแคลอรี่ต่อวัน", "2000 กิโลแคลอรี่ต่อวัน"],
                answer: "1600 กิโลแคลอรี่ต่อวัน"
            },
            {
                question: "ผู้ชายวัยทำงานต้องการพลังงาน (กิโลแคลอรี่) ประมาณเท่าไรต่อวัน",
                options: ["1400 กิโลแคลอรี่ต่อวัน", "1600 กิโลแคลอรี่ต่อวัน", "1800 กิโลแคลอรี่ต่อวัน", "2000 กิโลแคลอรี่ต่อวัน"],
                answer: "2000 กิโลแคลอรี่ต่อวัน"
            },
            {
                question: "นางสาว นพมาศ ศรีนคร รับประทานแตงโม 8 ชิ้น (1 ส่วน) มีคาร์โบไฮเดรต 15 กรัม คิดเป็นพลังงานเท่าใด",
                options: ["120 กิโลแคลอรี่", "100 กิโลแคลอรี่", "80 กิโลแคลอรี่", "60 กิโลแคลอรี่"],
                answer: "60 กิโลแคลอรี่"
            },
            {
                question: "นางสาว จิระประภา ทะเลไทย ดื่มน้ำหวาน มีน้ำตาลทราย 9 ช้อนชา คิดเป็นพลังงานเท่าใด",
                options: ["36 กิโลแคลอรี่", "66 กิโลแคลอรี่", "96 กิโลแคลอรี่", "144 กิโลแคลอรี่"],
                answer: "144 กิโลแคลอรี่"
            },
            {
                question: "นางสาว ศศิกานต์ รักธรรมชาติ รับประทานอาหารมื่อเที่ยงประกอบด้วย ข้าวสวย 3 ทัพพี ผักคะน้า 2 ทัพพี ไข่ไก่ 2 ฟอง กล้วยน้ำว้า 2 ผล คิดเป็นพลังงานเท่าใด",
                options: ["425 กิโลแคลอรี่", "500 กิโลแคลอรี่", "560 กิโลแคลอรี่", "600 กิโลแคลอรี่"],
                answer: "560 กิโลแคลอรี่"
            },
            {
                question: "อาหารกลุ่มข้าวแป้ง 3 ทัพพี เมื่อคิดเป็นปริมาณคาร์บคือเท่าใด",
                options: ["6 คาร์บ", "1 คาร์บ", "3 คาร์บ", "4 คาร์บ"],
                answer: "3 คาร์บ"
            },
            {
                question: "น้ำตาล 3 ช้อนชา เมื่อคิดเป็นปริมาณคาร์บคือเท่าใด",
                options: ["6 คาร์บ", "1 คาร์บ", "3 คาร์บ", "4 คาร์บ"],
                answer: "1 คาร์บ"
            },
            {
                question: "ผัก 3 ทัพพี เมื่อคิดเป็นปริมาณคาร์บคือเท่าใด",
                options: ["6 คาร์บ", "1 คาร์บ", "3 คาร์บ", "4 คาร์บ"],
                answer: "1 คาร์บ"
            },
            {
                question: "นม 1 แก้ว (240 ซีซี) เมื่อคิดเป็นปริมาณคาร์บคือเท่าใด",
                options: ["6 คาร์บ", "1 คาร์บ", "3 คาร์บ", "4 คาร์บ"],
                answer: "1 คาร์บ"
            },
            {
                question: "ตามคำแนะนำของกรมอนามัย ควรบริโภคน้ำตาลไม่เกินวันละกี่ช้อนชา",
                options: ["6 ช้อนชา", "1 ช้อนชา", "3 ช้อนชา", "4 ช้อนชา"],
                answer: "6 ช้อนชา"
            },
            {
                question: "การลดความเสี่ยงต่อการเกิดโรคความดันโลหิตสูง โรคไต ควรบริโภคโซเดียมไม่เกินวันละเท่าไร",
                options: ["2400 มิลลิกรัม", "2000 มิลลิกรัม", "2100 มิลลิกรัม", "2200 มิลลิกรัม"],
                answer: "2400 มิลลิกรัม"
            },
            {
                question: "ควรรับประทานผลไม้ปริมาณเท่าไรต่อวัน",
                options: ["1 - 3 ส่วนต่อวัน", "3 - 5 ส่วนต่อวัน", "6 - 8 ส่วนต่อวัน", "9 - 11 ส่วนต่อวัน"],
                answer: "3 - 5 ส่วนต่อวัน"
            },
            {
                question: "เนื้อสัตว์ (ไขมันสูง) ปริมาณ 6 ช้อนโต๊ะ คิดเป็นพลังงานเท่าไร",
                options: ["600 กิโลแคลอรี่", "300 กิโลแคลอรี่", "400 กิโลแคลอรี่", "500 กิโลแคลอรี่"],
                answer: "600 กิโลแคลอรี่"
            },
            {
                question: "กาแฟเย็น 1 แก้ว มีน้ำตาล 9 ช้อนชา เมื่อคิดเป็นปริมาณคาร์บคือเท่าใด",
                options: ["6 คาร์บ", "1 คาร์บ", "3 คาร์บ", "4 คาร์บ"],
                answer: "3 คาร์บ"
            },
            {
                question: "ผู้หญิงวัยทำงาน ควรบริโภคเนื้อสัตว์อย่างกี่ช้อนโต๊ะต่อวัน",
                options: ["6 ช้อนโต๊ะ", "1 ช้อนโต๊ะ", "3 ช้อนโต๊ะ", "4 ช้อนโต๊ะ"],
                answer: "6 ช้อนโต๊ะ"
            },
            {
                question: "เพื่อสุขภาพที่ดี ควรรับประทานผักประมาณเท่าไรต่อวัน",
                options: ["1 - 3 ทัพพีต่อวัน", "4 - 6 ทัพพีต่อวัน", "7 - 9 ทัพพีต่อวัน", "10 - 12 ทัพพีต่อวัน"],
                answer: "4 - 6 ทัพพีต่อวัน"
            },
            {
                question: "เมื่อต้องรับประทาน ข้าวโพด ทดแทน ข้าวสวย 1 ทัพพี รับประทาน ข้าวโพด ปริมาณเท่าไร",
                options: ["2 ฝัก", "1 ฝัก", "ครึ่ง ฝัก", "3 ฝัก"],
                answer: "1 ฝัก"
            },
            {
                question: "เมื่อต้องรับประทาน ขนมปัง ทดแทน ข้าวสวย 1 ทัพพี รับประทาน ขนมปัง ปริมาณเท่าไร",
                options: ["2 แผ่น", "1 แผ่น", "ครึ่ง แผ่น", "3 แผ่น"],
                answer: "1 แผ่น"
            }
        ];

        // Global variables
        let currentQuestionIndex = 0;
        let score = 0;
        let playerName = "";
        let timer;
        let timeLeft = 120; // 2 minutes in seconds
        let shuffledQuestions = [];
        let userAnswers = [];

        // DOM Elements
        const welcomeScreen = document.getElementById('welcome-screen');
        const quizScreen = document.getElementById('quiz-screen');
        const resultsScreen = document.getElementById('results-screen');
        const startBtn = document.getElementById('start-btn');
        const playerNameInput = document.getElementById('player-name');
        const displayName = document.getElementById('display-name');
        const currentQuestionElement = document.getElementById('current-question');
        const totalQuestionsElement = document.getElementById('total-questions');
        const currentScoreElement = document.getElementById('current-score');
        const questionText = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const timerElement = document.getElementById('timer');
        const timerFill = document.querySelector('.timer-fill');
        const progressFill = document.querySelector('.progress-fill');
        const resultName = document.getElementById('result-name');
        const finalScore = document.getElementById('final-score');
        const maxScore = document.getElementById('max-score');
        const circleProgress = document.getElementById('circle-progress');
        const percentageText = document.getElementById('percentage');
        const evaluationMessage = document.getElementById('evaluation-message');
        const restartBtn = document.getElementById('restart-btn');

        // Initialize the quiz
        function initQuiz() {
            // Shuffle questions
            shuffledQuestions = [...quizData].sort(() => Math.random() - 0.5);
            
            // Reset variables
            currentQuestionIndex = 0;
            score = 0;
            userAnswers = Array(shuffledQuestions.length).fill(null);
            
            // Update UI
            totalQuestionsElement.textContent = shuffledQuestions.length;
            currentScoreElement.textContent = score;
            
            // Load first question
            loadQuestion();
        }

        // Load question and options
        function loadQuestion() {
            const currentQuestion = shuffledQuestions[currentQuestionIndex];
            
            // Update question number and progress bar
            currentQuestionElement.textContent = currentQuestionIndex + 1;
            const progressPercentage = ((currentQuestionIndex + 1) / shuffledQuestions.length) * 100;
            progressFill.style.width = `${progressPercentage}%`;
            
            // Set question text
            questionText.textContent = currentQuestion.question;
            
            // Clear previous options
            optionsContainer.innerHTML = '';
            
            // Shuffle options
            const shuffledOptions = [...currentQuestion.options].sort(() => Math.random() - 0.5);
            
            // Create option buttons
            shuffledOptions.forEach((option, index) => {
                const optionBtn = document.createElement('button');
                optionBtn.className = 'option-btn p-4 rounded-lg text-left flex items-center';
                
                // Check if this option was previously selected
                if (userAnswers[currentQuestionIndex] === option) {
                    optionBtn.classList.add('selected');
                }
                
                // Option letter (A, B, C, D)
                const optionLetter = String.fromCharCode(65 + index);
                
                optionBtn.innerHTML = `
                    <span class="w-8 h-8 rounded-full bg-green-100 text-green-600 flex items-center justify-center font-semibold mr-3">${optionLetter}</span>
                    <span>${option}</span>
                `;
                
                optionBtn.addEventListener('click', () => selectOption(option, optionBtn));
                optionsContainer.appendChild(optionBtn);
            });
            
            // Update navigation buttons
            prevBtn.disabled = currentQuestionIndex === 0;
            prevBtn.classList.toggle('opacity-50', currentQuestionIndex === 0);
            prevBtn.classList.toggle('cursor-not-allowed', currentQuestionIndex === 0);
            
            nextBtn.textContent = currentQuestionIndex === shuffledQuestions.length - 1 ? 'ส่งคำตอบ' : 'ข้อถัดไป';
            nextBtn.innerHTML = currentQuestionIndex === shuffledQuestions.length - 1 ? 
                '<i class="fas fa-check-circle mr-2"></i> ส่งคำตอบ' : 
                'ข้อถัดไป <i class="fas fa-arrow-right ml-2"></i>';
            
            // Reset timer
            resetTimer();
        }

        // Select an option
        function selectOption(option, optionBtn) {
            // Remove selected class from all options
            const allOptions = document.querySelectorAll('.option-btn');
            allOptions.forEach(btn => btn.classList.remove('selected'));
            
            // Add selected class to clicked option
            optionBtn.classList.add('selected');
            
            // Save user's answer
            userAnswers[currentQuestionIndex] = option;
            
            // Check if answer is correct
            const currentQuestion = shuffledQuestions[currentQuestionIndex];
            if (option === currentQuestion.answer && !userAnswers.hasOwnProperty(currentQuestionIndex)) {
                score++;
                currentScoreElement.textContent = score;
            }
        }

        // Go to next question
        function nextQuestion() {
            if (currentQuestionIndex < shuffledQuestions.length - 1) {
                currentQuestionIndex++;
                loadQuestion();
            } else {
                finishQuiz();
            }
        }

        // Go to previous question
        function prevQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                loadQuestion();
            }
        }

        // Reset timer
        function resetTimer() {
            clearInterval(timer);
            timeLeft = 120; // 2 minutes
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    nextQuestion();
                }
            }, 1000);
        }

        // Update timer display
        function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            timerElement.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
            
            // Update timer bar
            const percentage = (timeLeft / 120) * 100;
            timerFill.style.width = `${percentage}%`;
            
            // Change color based on time left
            if (timeLeft <= 30) {
                timerFill.style.backgroundColor = '#e74c3c';
            } else if (timeLeft <= 60) {
                timerFill.style.backgroundColor = '#f39c12';
            } else {
                timerFill.style.backgroundColor = '#2ecc71';
            }
        }

        // Finish quiz and show results
        function finishQuiz() {
            clearInterval(timer);
            
            // Calculate final score
            calculateScore();
            
            // Hide quiz screen and show results screen
            quizScreen.classList.add('hidden');
            resultsScreen.classList.remove('hidden');
            
            // Update results
            resultName.textContent = playerName;
            finalScore.textContent = score;
            maxScore.textContent = shuffledQuestions.length;
            
            // Update progress circle
            const percentage = Math.round((score / shuffledQuestions.length) * 100);
            const circumference = 2 * Math.PI * 15.9155;
            const offset = circumference - (percentage / 100) * circumference;
            circleProgress.style.strokeDasharray = `${circumference - offset}, ${circumference}`;
            percentageText.textContent = `${percentage}%`;
            
            // Set evaluation message
            setEvaluationMessage(percentage);
            
            // Create confetti effect for good scores
            if (percentage >= 70) {
                createConfetti();
            }
        }

        // Calculate final score
        function calculateScore() {
            score = 0;
            shuffledQuestions.forEach((question, index) => {
                if (userAnswers[index] === question.answer) {
                    score++;
                }
            });
        }

        // Set evaluation message based on score percentage
        function setEvaluationMessage(percentage) {
            let message = '';
            let icon = '';
            
            if (percentage >= 90) {
                icon = '<i class="fas fa-trophy text-yellow-500 mr-2"></i>';
                message = 'ยอดเยี่ยม! คุณมีความรู้ด้านอาหารและโภชนาการในระดับดีเยี่ยม คุณเข้าใจหลักการโภชนาการอย่างลึกซึ้ง';
            } else if (percentage >= 80) {
                icon = '<i class="fas fa-medal text-green-500 mr-2"></i>';
                message = 'ดีมาก! คุณมีความรู้ด้านอาหารและโภชนาการในระดับดี คุณเข้าใจหลักการโภชนาการเป็นอย่างดี';
            } else if (percentage >= 70) {
                icon = '<i class="fas fa-thumbs-up text-blue-500 mr-2"></i>';
                message = 'ดี! คุณมีความรู้ด้านอาหารและโภชนาการในระดับค่อนข้างดี แต่ยังมีบางจุดที่สามารถพัฒนาได้อีก';
            } else if (percentage >= 60) {
                icon = '<i class="fas fa-check-circle text-blue-400 mr-2"></i>';
                message = 'พอใช้! คุณมีความรู้พื้นฐานด้านอาหารและโภชนาการ แต่ควรศึกษาเพิ่มเติมในบางหัวข้อ';
            } else if (percentage >= 50) {
                icon = '<i class="fas fa-info-circle text-yellow-500 mr-2"></i>';
                message = 'ผ่าน! คุณมีความรู้ด้านอาหารและโภชนาการในระดับพอผ่าน ควรทบทวนความรู้เพิ่มเติม';
            } else {
                icon = '<i class="fas fa-book-open text-red-500 mr-2"></i>';
                message = 'ควรปรับปรุง! คุณควรศึกษาความรู้ด้านอาหารและโภชนาการเพิ่มเติม เพื่อการดูแลสุขภาพที่ดีขึ้น';
            }
            
            evaluationMessage.innerHTML = `<div class="flex items-start">${icon}<span>${message}</span></div>`;
        }

        // Create confetti effect
        function createConfetti() {
            const confettiContainer = document.getElementById('confetti-container');
            const colors = ['#2ecc71', '#3498db', '#9b59b6', '#f1c40f', '#e74c3c'];
            
            for (let i = 0; i < 100; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = `${Math.random() * 100}%`;
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.width = `${Math.random() * 10 + 5}px`;
                confetti.style.height = `${Math.random() * 10 + 5}px`;
                confetti.style.opacity = Math.random();
                confetti.style.animationDuration = `${Math.random() * 3 + 2}s`;
                confetti.style.animationDelay = `${Math.random() * 2}s`;
                
                confettiContainer.appendChild(confetti);
            }
        }

        // Event listeners
        startBtn.addEventListener('click', () => {
            playerName = playerNameInput.value.trim();
            if (!playerName) {
                playerName = "ผู้เล่นไม่ระบุชื่อ";
            }
            
            displayName.textContent = playerName;
            welcomeScreen.classList.add('hidden');
            quizScreen.classList.remove('hidden');
            
            initQuiz();
        });

        prevBtn.addEventListener('click', prevQuestion);
        nextBtn.addEventListener('click', nextQuestion);
        restartBtn.addEventListener('click', () => {
            resultsScreen.classList.add('hidden');
            welcomeScreen.classList.remove('hidden');
            playerNameInput.value = '';
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'93a64ef32375d018',t:'MTc0NjM0Mzk5MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>