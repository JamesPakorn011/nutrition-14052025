
<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>แบบทดสอบความรู้ด้านอาหารและโภชนาการ</title>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * {
            font-family: 'Prompt', sans-serif;
        }
        
        body {
            background-color: #f0f9f4;
        }
        
        .quiz-option {
            transition: all 0.3s ease;
        }
        
        .quiz-option:hover {
            transform: translateY(-2px);
        }
        
        .quiz-option.active {
            background-color: #4ade80;
            border-color: #16a34a;
            color: white;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        
        .timer-warning {
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }
        
        .dashboard-card {
            transition: all 0.3s ease;
        }
        
        .dashboard-card:hover {
            transform: translateY(-5px);
        }
        
        .btn-primary {
            background-color: #10b981;
            color: white;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            background-color: #059669;
        }
        
        .btn-secondary {
            background-color: #f0fdf4;
            color: #10b981;
            border: 1px solid #10b981;
            transition: all 0.3s ease;
        }
        
        .btn-secondary:hover {
            background-color: #dcfce7;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="bg-white shadow-md py-4">
        <div class="container mx-auto px-4 flex flex-col items-center">
            <div class="w-[120px] h-[120px] mb-2">
                <svg viewBox="0 0 100 100" class="w-full h-full">
                    <circle cx="50" cy="50" r="45" fill="#e6f7ec" />
                    <g transform="translate(25, 25) scale(0.5)">
                        <path d="M50,15 C32,15 15,32 15,50 C15,68 32,85 50,85 C68,85 85,68 85,50 C85,32 68,15 50,15 Z" fill="#4ade80" />
                        <path d="M40,35 L40,65 L70,50 Z" fill="white" />
                        <circle cx="30" cy="30" r="8" fill="#16a34a" />
                        <circle cx="70" cy="30" r="8" fill="#16a34a" />
                        <circle cx="30" cy="70" r="8" fill="#16a34a" />
                        <circle cx="70" cy="70" r="8" fill="#16a34a" />
                    </g>
                    <path d="M50,10 C27.9,10 10,27.9 10,50 C10,72.1 27.9,90 50,90 C72.1,90 90,72.1 90,50 C90,27.9 72.1,10 50,10 Z M50,15 C69.3,15 85,30.7 85,50 C85,69.3 69.3,85 50,85 C30.7,85 15,69.3 15,50 C15,30.7 30.7,15 50,15 Z" fill="#16a34a" />
                </svg>
            </div>
            <h1 class="text-2xl md:text-3xl font-bold text-center text-gray-800">แบบทดสอบความรู้ (Post-Test) ด้านอาหารและโภชนาการ กลุ่มวัยทำงาน</h1>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Registration Screen -->
        <div id="registration-screen" class="bg-white rounded-lg shadow-lg p-6 max-w-md mx-auto">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">ลงทะเบียนก่อนเริ่มทำแบบทดสอบ</h2>
            <div class="mb-4">
                <label for="user-name" class="block text-gray-700 mb-2">ชื่อ-นามสกุล</label>
                <input type="text" id="user-name" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="กรุณากรอกชื่อ-นามสกุล" required>
                <p id="name-error" class="text-red-500 text-sm mt-1 hidden">กรุณากรอกชื่อ-นามสกุลก่อนเริ่มทำแบบทดสอบ</p>
            </div>
            <button id="start-quiz-btn" class="btn-primary w-full py-2 px-4 rounded-md font-medium flex items-center justify-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd" />
                </svg>
                เริ่มทำแบบทดสอบ
            </button>
        </div>

        <!-- Quiz Screen -->
        <div id="quiz-screen" class="hidden">
            <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
                <div class="flex flex-col md:flex-row justify-between items-center mb-4">
                    <div>
                        <h2 class="text-xl font-semibold text-gray-800">แบบทดสอบความรู้ด้านอาหารและโภชนาการ</h2>
                        <p class="text-gray-600" id="user-display"></p>
                    </div>
                    <div class="flex items-center mt-2 md:mt-0">
                        <div class="bg-green-100 text-green-800 py-1 px-3 rounded-full text-sm font-medium mr-3">
                            <span id="current-question">1</span>/<span id="total-questions">20</span> ข้อ
                        </div>
                        <div id="timer" class="bg-blue-100 text-blue-800 py-1 px-3 rounded-full text-sm font-medium flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd" />
                            </svg>
                            <span id="time-remaining">2:00</span>
                        </div>
                    </div>
                </div>

                <div class="border-t border-gray-200 pt-4">
                    <h3 id="question-text" class="text-lg font-medium text-gray-800 mb-4"></h3>
                    <div id="options-container" class="space-y-3">
                        <!-- Options will be generated here -->
                    </div>
                </div>
            </div>

            <div class="flex justify-between">
                <button id="prev-btn" class="btn-secondary py-2 px-4 rounded-md font-medium flex items-center" disabled>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd" />
                    </svg>
                    ข้อก่อนหน้า
                </button>
                <button id="next-btn" class="btn-primary py-2 px-4 rounded-md font-medium flex items-center">
                    ข้อถัดไป
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-1" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd" />
                    </svg>
                </button>
            </div>
        </div>

        <!-- Results Screen -->
        <div id="results-screen" class="hidden">
            <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
                <div class="text-center mb-6">
                    <div class="inline-block p-4 rounded-full bg-green-100 mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                    </div>
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">การทดสอบเสร็จสิ้น!</h2>
                    <p class="text-gray-600" id="result-user-name"></p>
                </div>

                <div class="bg-green-50 rounded-lg p-4 mb-6">
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-gray-700 font-medium">คะแนนของคุณ:</span>
                        <span id="score-display" class="text-xl font-bold text-green-600">0/20</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2.5">
                        <div id="score-bar" class="bg-green-600 h-2.5 rounded-full" style="width: 0%"></div>
                    </div>
                </div>

                <div class="mb-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-3">เฉลยคำตอบ</h3>
                    <div id="answers-container" class="space-y-4">
                        <!-- Answers will be generated here -->
                    </div>
                </div>

                <div class="flex flex-col sm:flex-row gap-3">
                    <button id="retry-btn" class="btn-secondary py-2 px-4 rounded-md font-medium flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd" />
                        </svg>
                        ทำแบบทดสอบอีกครั้ง
                    </button>
                    <button id="dashboard-btn" class="btn-primary py-2 px-4 rounded-md font-medium flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M2 10a8 8 0 018-8v8h8a8 8 0 11-16 0z" />
                            <path d="M12 2.252A8.014 8.014 0 0117.748 8H12V2.252z" />
                        </svg>
                        ดูแดชบอร์ด
                    </button>
                </div>
            </div>
        </div>

        <!-- Dashboard Screen -->
        <div id="dashboard-screen" class="hidden">
            <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-semibold text-gray-800">แดชบอร์ดสรุปสถิติ</h2>
                    <button id="back-to-results-btn" class="btn-secondary py-1 px-3 rounded-md text-sm font-medium flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd" />
                        </svg>
                        กลับไปหน้าผลลัพธ์
                    </button>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                    <div class="dashboard-card bg-green-50 rounded-lg p-4 border border-green-200">
                        <div class="flex items-center">
                            <div class="p-2 rounded-full bg-green-100 mr-3">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                                </svg>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500">จำนวนผู้ทำแบบทดสอบ</p>
                                <p id="total-users" class="text-xl font-bold text-gray-800">1</p>
                            </div>
                        </div>
                    </div>
                    <div class="dashboard-card bg-green-50 rounded-lg p-4 border border-green-200">
                        <div class="flex items-center">
                            <div class="p-2 rounded-full bg-green-100 mr-3">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                                </svg>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500">คะแนนเฉลี่ย</p>
                                <p id="average-score" class="text-xl font-bold text-gray-800">0%</p>
                            </div>
                        </div>
                    </div>
                    <div class="dashboard-card bg-green-50 rounded-lg p-4 border border-green-200">
                        <div class="flex items-center">
                            <div class="p-2 rounded-full bg-green-100 mr-3">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" />
                                </svg>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500">คะแนนสูงสุด</p>
                                <p id="highest-score" class="text-xl font-bold text-gray-800">0%</p>
                            </div>
                        </div>
                    </div>
                    <div class="dashboard-card bg-green-50 rounded-lg p-4 border border-green-200">
                        <div class="flex items-center">
                            <div class="p-2 rounded-full bg-green-100 mr-3">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                                </svg>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500">เวลาเฉลี่ย</p>
                                <p id="average-time" class="text-xl font-bold text-gray-800">0:00</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="bg-green-50 rounded-lg p-4 border border-green-200 mb-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-3">ประวัติการทำแบบทดสอบ</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-white">
                            <thead>
                                <tr>
                                    <th class="py-2 px-4 border-b border-gray-200 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ชื่อ-นามสกุล</th>
                                    <th class="py-2 px-4 border-b border-gray-200 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">วันที่ทำแบบทดสอบ</th>
                                    <th class="py-2 px-4 border-b border-gray-200 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">คะแนน</th>
                                    <th class="py-2 px-4 border-b border-gray-200 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">เวลาที่ใช้</th>
                                </tr>
                            </thead>
                            <tbody id="history-table-body">
                                <!-- History will be generated here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-green-50 rounded-lg p-4 border border-green-200">
                        <h3 class="text-lg font-semibold text-gray-800 mb-3">ข้อที่ตอบถูกมากที่สุด</h3>
                        <div id="most-correct-container" class="space-y-2">
                            <!-- Most correct questions will be generated here -->
                        </div>
                    </div>
                    <div class="bg-green-50 rounded-lg p-4 border border-green-200">
                        <h3 class="text-lg font-semibold text-gray-800 mb-3">ข้อที่ตอบผิดมากที่สุด</h3>
                        <div id="most-incorrect-container" class="space-y-2">
                            <!-- Most incorrect questions will be generated here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="py-4 mt-8">
        <div class="container mx-auto px-4">
            <p class="text-center text-gray-400 text-sm">© 2025 JamesPakorn</p>
        </div>
    </footer>

    <script>
        // Quiz questions and answers
        const quizData = [
            {
                question: "นางสาวรติมา ใจชื่อ น้ำหนัก 80 ส่วนสูง 160 มีค่าดัชนีมวลกายเป็นเท่าไร",
                options: ["23.25", "25.25", "31.25", "33.25"],
                answer: "31.25"
            },
            {
                question: "นางสาวรติมา ใจชื่อ น้ำหนัก 80 ส่วนสูง 160 เมื่อแปลผลระดับดัชนีมวลกาย (BMI) อยู่ในระดับใด",
                options: ["ปกติ", "น้ำหนักเกิน", "อ้วนระดับ 1", "อ้วนระดับ 2"],
                answer: "อ้วนระดับ 2"
            },
            {
                question: "ผู้หญิงวัยทำงานต้องการพลังงาน (กิโลแคลอรี่) ประมาณเท่าไรต่อวัน",
                options: ["1400 กิโลแคลอรี่ต่อวัน", "1600 กิโลแคลอรี่ต่อวัน", "1800 กิโลแคลอรี่ต่อวัน", "2000 กิโลแคลอรี่ต่อวัน"],
                answer: "1600 กิโลแคลอรี่ต่อวัน"
            },
            {
                question: "ผู้ชายวัยทำงานต้องการพลังงาน (กิโลแคลอรี่) ประมาณเท่าไรต่อวัน",
                options: ["1400 กิโลแคลอรี่ต่อวัน", "1600 กิโลแคลอรี่ต่อวัน", "1800 กิโลแคลอรี่ต่อวัน", "2000 กิโลแคลอรี่ต่อวัน"],
                answer: "2000 กิโลแคลอรี่ต่อวัน"
            },
            {
                question: "นางสาว นพมาศ ศรีนคร รับประทานแตงโม 8 ชิ้น (1 ส่วน) มีคาร์โบไฮเดรต 15 กรัม คิดเป็นพลังงานเท่าใด",
                options: ["120 กิโลแคลอรี่", "100 กิโลแคลอรี่", "80 กิโลแคลอรี่", "60 กิโลแคลอรี่"],
                answer: "60 กิโลแคลอรี่"
            },
            {
                question: "นางสาว จิระประภา ทะเลไทย ดื่มน้ำหวาน มีน้ำตาลทราย 9 ช้อนชา คิดเป็นพลังงานเท่าใด",
                options: ["36 กิโลแคลอรี่", "66 กิโลแคลอรี่", "96 กิโลแคลอรี่", "144 กิโลแคลอรี่"],
                answer: "144 กิโลแคลอรี่"
            },
            {
                question: "นางสาว ศศิกานต์ รักธรรมชาติ รับประทานอาหารมื่อเที่ยงประกอบด้วย ข้าวสวย 3 ทัพพี ผักคะน้า 2 ทัพพี ไข่ไก่ 2 ฟอง กล้วยน้ำว้า 2 ผล คิดเป็นพลังงานเท่าใด",
                options: ["425 กิโลแคลอรี่", "500 กิโลแคลอรี่", "560 กิโลแคลอรี่", "600 กิโลแคลอรี่"],
                answer: "560 กิโลแคลอรี่"
            },
            {
                question: "อาหารกลุ่มข้าวแป้ง 3 ทัพพี เมื่อคิดเป็นปริมาณคาร์บคือเท่าใด",
                options: ["6 คาร์บ", "1 คาร์บ", "3 คาร์บ", "4 คาร์บ"],
                answer: "3 คาร์บ"
            },
            {
                question: "น้ำตาล 3 ช้อนชา เมื่อคิดเป็นปริมาณคาร์บคือเท่าใด",
                options: ["6 คาร์บ", "1 คาร์บ", "3 คาร์บ", "4 คาร์บ"],
                answer: "1 คาร์บ"
            },
            {
                question: "ผัก 3 ทัพพี เมื่อคิดเป็นปริมาณคาร์บคือเท่าใด",
                options: ["6 คาร์บ", "1 คาร์บ", "3 คาร์บ", "4 คาร์บ"],
                answer: "1 คาร์บ"
            },
            {
                question: "นม 1 แก้ว (240 ซีซี) เมื่อคิดเป็นปริมาณคาร์บคือเท่าใด",
                options: ["6 คาร์บ", "1 คาร์บ", "3 คาร์บ", "4 คาร์บ"],
                answer: "1 คาร์บ"
            },
            {
                question: "ตามคำแนะนำของกรมอนามัย ควรบริโภคน้ำตาลไม่เกินวันละกี่ช้อนชา",
                options: ["6 ช้อนชา", "1 ช้อนชา", "3 ช้อนชา", "4 ช้อนชา"],
                answer: "6 ช้อนชา"
            },
            {
                question: "การลดความเสี่ยงต่อการเกิดโรคความดันโลหิตสูง โรคไต ควรบริโภคโซเดียมไม่เกินวันละเท่าไร",
                options: ["2400 มิลลิกรัม", "2000 มิลลิกรัม", "2100 มิลลิกรัม", "2200 มิลลิกรัม"],
                answer: "2000 มิลลิกรัม"
            },
            {
                question: "ควรรับประทานผลไม้ปริมาณเท่าไรต่อวัน",
                options: ["1 - 3 ส่วนต่อวัน", "3 - 5 ส่วนต่อวัน", "6 - 8 ส่วนต่อวัน", "9 - 11 ส่วนต่อวัน"],
                answer: "3 - 5 ส่วนต่อวัน"
            },
            {
                question: "เนื้อสัตว์ (ไขมันสูง) ปริมาณ 6 ช้อนโต๊ะ คิดเป็นพลังงานเท่าไร",
                options: ["600 กิโลแคลอรี่", "300 กิโลแคลอรี่", "400 กิโลแคลอรี่", "500 กิโลแคลอรี่"],
                answer: "300 กิโลแคลอรี่"
            },
            {
                question: "กาแฟเย็น 1 แก้ว มีน้ำตาล 9 ช้อนชา เมื่อคิดเป็นปริมาณคาร์บคือเท่าใด",
                options: ["6 คาร์บ", "1 คาร์บ", "3 คาร์บ", "4 คาร์บ"],
                answer: "3 คาร์บ"
            },
            {
                question: "ผู้หญิงวัยทำงาน ควรบริโภคเนื้อสัตว์อย่างกี่ช้อนโต๊ะต่อวัน",
                options: ["6 ช้อนโต๊ะ", "1 ช้อนโต๊ะ", "3 ช้อนโต๊ะ", "4 ช้อนโต๊ะ"],
                answer: "6 ช้อนโต๊ะ"
            },
            {
                question: "เพื่อสุขภาพที่ดี ควรรับประทานผักประมาณเท่าไรต่อวัน",
                options: ["1 - 3 ทัพพีต่อวัน", "4 - 6 ทัพพีต่อวัน", "7 - 9 ทัพพีต่อวัน", "10 - 12 ทัพพีต่อวัน"],
                answer: "4 - 6 ทัพพีต่อวัน"
            },
            {
                question: "เมื่อต้องรับประทาน ข้าวโพด ทดแทน ข้าวสวย 1 ทัพพี รับประทาน ข้าวโพด ปริมาณเท่าไร",
                options: ["2 ฝัก", "1 ฝัก", "ครึ่ง ฝัก", "3 ฝัก"],
                answer: "1 ฝัก"
            },
            {
                question: "เมื่อต้องรับประทาน ขนมปัง ทดแทน ข้าวสวย 1 ทัพพี รับประทาน ขนมปัง ปริมาณเท่าไร",
                options: ["2 แผ่น", "1 แผ่น", "ครึ่ง แผ่น", "3 แผ่น"],
                answer: "1 แผ่น"
            }
        ];

        // Global variables
        let currentQuestionIndex = 0;
        let userAnswers = Array(quizData.length).fill(null);
        let timerInterval;
        let timeRemaining = 120; // 2 minutes per question
        let quizHistory = JSON.parse(localStorage.getItem('quizHistory')) || [];
        let userName = '';
        let startTime;
        let totalTime = 0;
        let shuffledQuestions = [];
        
        // DOM elements
        const registrationScreen = document.getElementById('registration-screen');
        const quizScreen = document.getElementById('quiz-screen');
        const resultsScreen = document.getElementById('results-screen');
        const dashboardScreen = document.getElementById('dashboard-screen');
        const startQuizBtn = document.getElementById('start-quiz-btn');
        const userNameInput = document.getElementById('user-name');
        const nameError = document.getElementById('name-error');
        const userDisplay = document.getElementById('user-display');
        const questionText = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const currentQuestionEl = document.getElementById('current-question');
        const totalQuestionsEl = document.getElementById('total-questions');
        const timeRemainingEl = document.getElementById('time-remaining');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const resultUserName = document.getElementById('result-user-name');
        const scoreDisplay = document.getElementById('score-display');
        const scoreBar = document.getElementById('score-bar');
        const answersContainer = document.getElementById('answers-container');
        const retryBtn = document.getElementById('retry-btn');
        const dashboardBtn = document.getElementById('dashboard-btn');
        const backToResultsBtn = document.getElementById('back-to-results-btn');
        const totalUsers = document.getElementById('total-users');
        const averageScore = document.getElementById('average-score');
        const highestScore = document.getElementById('highest-score');
        const averageTime = document.getElementById('average-time');
        const historyTableBody = document.getElementById('history-table-body');
        const mostCorrectContainer = document.getElementById('most-correct-container');
        const mostIncorrectContainer = document.getElementById('most-incorrect-container');

        // Initialize the quiz
        function initQuiz() {
            // Set total questions
            totalQuestionsEl.textContent = quizData.length;
            
            // Event listeners
            startQuizBtn.addEventListener('click', startQuiz);
            prevBtn.addEventListener('click', goToPreviousQuestion);
            nextBtn.addEventListener('click', goToNextQuestion);
            retryBtn.addEventListener('click', resetQuiz);
            dashboardBtn.addEventListener('click', showDashboard);
            backToResultsBtn.addEventListener('click', showResults);
        }

        // Start the quiz
        function startQuiz() {
            userName = userNameInput.value.trim();
            if (!userName) {
                nameError.classList.remove('hidden');
                return;
            }
            
            // Shuffle questions
            shuffledQuestions = [...quizData].sort(() => Math.random() - 0.5);
            
            // Initialize quiz state
            currentQuestionIndex = 0;
            userAnswers = Array(shuffledQuestions.length).fill(null);
            startTime = new Date();
            
            // Update UI
            registrationScreen.classList.add('hidden');
            quizScreen.classList.remove('hidden');
            userDisplay.textContent = `ผู้ทำแบบทดสอบ: ${userName}`;
            
            // Load first question
            loadQuestion();
            
            // Start timer
            startTimer();
        }

        // Load question
        function loadQuestion() {
            const question = shuffledQuestions[currentQuestionIndex];
            
            // Update question number
            currentQuestionEl.textContent = currentQuestionIndex + 1;
            
            // Set question text
            questionText.textContent = question.question;
            
            // Clear previous options
            optionsContainer.innerHTML = '';
            
            // Shuffle options
            const shuffledOptions = [...question.options].sort(() => Math.random() - 0.5);
            
            // Create option elements
            shuffledOptions.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = `quiz-option p-3 border rounded-lg cursor-pointer transition-all ${userAnswers[currentQuestionIndex] === option ? 'active' : ''}`;
                optionDiv.textContent = option;
                optionDiv.addEventListener('click', () => selectOption(option));
                optionsContainer.appendChild(optionDiv);
            });
            
            // Update navigation buttons
            prevBtn.disabled = currentQuestionIndex === 0;
            nextBtn.textContent = currentQuestionIndex === shuffledQuestions.length - 1 ? 'ส่งคำตอบ' : 'ข้อถัดไป';
            
            // Reset timer for new question
            resetTimer();
        }

        // Select option
        function selectOption(option) {
            userAnswers[currentQuestionIndex] = option;
            
            // Update UI to show selected option
            const options = optionsContainer.querySelectorAll('.quiz-option');
            options.forEach(opt => {
                opt.classList.remove('active');
                if (opt.textContent === option) {
                    opt.classList.add('active');
                }
            });
        }

        // Go to previous question
        function goToPreviousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                loadQuestion();
            }
        }

        // Go to next question
        function goToNextQuestion() {
            // Check if an option is selected
            if (userAnswers[currentQuestionIndex] === null) {
                alert('กรุณาเลือกคำตอบก่อนไปข้อถัดไป');
                return;
            }
            
            if (currentQuestionIndex < shuffledQuestions.length - 1) {
                currentQuestionIndex++;
                loadQuestion();
            } else {
                finishQuiz();
            }
        }

        // Start timer
        function startTimer() {
            clearInterval(timerInterval);
            timeRemaining = 120; // 2 minutes
            updateTimerDisplay();
            
            timerInterval = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 30) {
                    timeRemainingEl.parentElement.classList.add('timer-warning', 'bg-red-100', 'text-red-800');
                    timeRemainingEl.parentElement.classList.remove('bg-blue-100', 'text-blue-800');
                }
                
                if (timeRemaining <= 0) {
                    clearInterval(timerInterval);
                    
                    // If no answer selected, select first option
                    if (userAnswers[currentQuestionIndex] === null) {
                        const firstOption = shuffledQuestions[currentQuestionIndex].options[0];
                        selectOption(firstOption);
                    }
                    
                    // Move to next question or finish quiz
                    if (currentQuestionIndex < shuffledQuestions.length - 1) {
                        currentQuestionIndex++;
                        loadQuestion();
                    } else {
                        finishQuiz();
                    }
                }
            }, 1000);
        }

        // Reset timer
        function resetTimer() {
            clearInterval(timerInterval);
            timeRemaining = 120; // 2 minutes
            updateTimerDisplay();
            timeRemainingEl.parentElement.classList.remove('timer-warning', 'bg-red-100', 'text-red-800');
            timeRemainingEl.parentElement.classList.add('bg-blue-100', 'text-blue-800');
            startTimer();
        }

        // Update timer display
        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            timeRemainingEl.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
        }

        // Finish quiz
        function finishQuiz() {
            clearInterval(timerInterval);
            
            // Calculate total time
            const endTime = new Date();
            totalTime = Math.floor((endTime - startTime) / 1000); // in seconds
            
            // Calculate score
            let score = 0;
            shuffledQuestions.forEach((question, index) => {
                if (userAnswers[index] === question.answer) {
                    score++;
                }
            });
            
            // Save to history
            const quizResult = {
                name: userName,
                date: new Date().toLocaleDateString('th-TH'),
                score: score,
                totalQuestions: shuffledQuestions.length,
                time: totalTime,
                answers: userAnswers.map((answer, index) => ({
                    question: shuffledQuestions[index].question,
                    userAnswer: answer,
                    correctAnswer: shuffledQuestions[index].answer,
                    isCorrect: answer === shuffledQuestions[index].answer
                }))
            };
            
            quizHistory.push(quizResult);
            localStorage.setItem('quizHistory', JSON.stringify(quizHistory));
            
            // Show results
            showResults();
        }

        // Show results
        function showResults() {
            quizScreen.classList.add('hidden');
            dashboardScreen.classList.add('hidden');
            resultsScreen.classList.remove('hidden');
            
            // Get latest result
            const latestResult = quizHistory[quizHistory.length - 1];
            
            // Update UI
            resultUserName.textContent = `ผู้ทำแบบทดสอบ: ${latestResult.name}`;
            scoreDisplay.textContent = `${latestResult.score}/${latestResult.totalQuestions}`;
            const scorePercentage = (latestResult.score / latestResult.totalQuestions) * 100;
            scoreBar.style.width = `${scorePercentage}%`;
            
            // Generate answers
            answersContainer.innerHTML = '';
            latestResult.answers.forEach((item, index) => {
                const answerDiv = document.createElement('div');
                answerDiv.className = `p-3 rounded-lg ${item.isCorrect ? 'bg-green-50 border border-green-200' : 'bg-red-50 border border-red-200'}`;
                
                answerDiv.innerHTML = `
                    <p class="font-medium mb-2">${index + 1}. ${item.question}</p>
                    <div class="flex flex-col sm:flex-row sm:items-center text-sm">
                        <div class="mb-1 sm:mb-0 sm:mr-4">
                            <span class="font-medium">คำตอบของคุณ:</span> 
                            <span class="${item.isCorrect ? 'text-green-600' : 'text-red-600'}">${item.userAnswer}</span>
                        </div>
                        ${!item.isCorrect ? `
                        <div>
                            <span class="font-medium">คำตอบที่ถูกต้อง:</span> 
                            <span class="text-green-600">${item.correctAnswer}</span>
                        </div>
                        ` : ''}
                    </div>
                `;
                
                answersContainer.appendChild(answerDiv);
            });
        }

        // Show dashboard
        function showDashboard() {
            resultsScreen.classList.add('hidden');
            dashboardScreen.classList.remove('hidden');
            
            // Calculate statistics
            totalUsers.textContent = quizHistory.length;
            
            const totalScorePercentage = quizHistory.reduce((sum, result) => {
                return sum + (result.score / result.totalQuestions) * 100;
            }, 0);
            const avgScore = totalScorePercentage / quizHistory.length;
            averageScore.textContent = `${avgScore.toFixed(1)}%`;
            
            const highScore = Math.max(...quizHistory.map(result => (result.score / result.totalQuestions) * 100));
            highestScore.textContent = `${highScore.toFixed(1)}%`;
            
            const totalTimeInSeconds = quizHistory.reduce((sum, result) => sum + result.time, 0);
            const avgTimeInSeconds = totalTimeInSeconds / quizHistory.length;
            const avgMinutes = Math.floor(avgTimeInSeconds / 60);
            const avgSeconds = Math.floor(avgTimeInSeconds % 60);
            averageTime.textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            // Generate history table
            historyTableBody.innerHTML = '';
            quizHistory.slice().reverse().forEach(result => {
                const row = document.createElement('tr');
                
                const minutes = Math.floor(result.time / 60);
                const seconds = result.time % 60;
                const timeString = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                row.innerHTML = `
                    <td class="py-2 px-4 border-b border-gray-200">${result.name}</td>
                    <td class="py-2 px-4 border-b border-gray-200">${result.date}</td>
                    <td class="py-2 px-4 border-b border-gray-200">${result.score}/${result.totalQuestions} (${((result.score / result.totalQuestions) * 100).toFixed(1)}%)</td>
                    <td class="py-2 px-4 border-b border-gray-200">${timeString}</td>
                `;
                
                historyTableBody.appendChild(row);
            });
            
            // Calculate most correct and incorrect questions
            const questionStats = {};
            
            quizHistory.forEach(result => {
                result.answers.forEach(answer => {
                    if (!questionStats[answer.question]) {
                        questionStats[answer.question] = {
                            correct: 0,
                            incorrect: 0,
                            total: 0,
                            correctAnswer: answer.correctAnswer
                        };
                    }
                    
                    questionStats[answer.question].total++;
                    if (answer.isCorrect) {
                        questionStats[answer.question].correct++;
                    } else {
                        questionStats[answer.question].incorrect++;
                    }
                });
            });
            
            // Sort questions by correct percentage
            const sortedQuestions = Object.entries(questionStats).sort((a, b) => {
                const aCorrectPercentage = (a[1].correct / a[1].total) * 100;
                const bCorrectPercentage = (b[1].correct / b[1].total) * 100;
                return bCorrectPercentage - aCorrectPercentage;
            });
            
            // Display most correct questions
            mostCorrectContainer.innerHTML = '';
            sortedQuestions.slice(0, 3).forEach((item, index) => {
                const [question, stats] = item;
                const correctPercentage = (stats.correct / stats.total) * 100;
                
                const div = document.createElement('div');
                div.className = 'p-2 border-b border-green-200 last:border-b-0';
                div.innerHTML = `
                    <p class="font-medium text-sm mb-1">${question}</p>
                    <div class="flex items-center">
                        <div class="w-full bg-gray-200 rounded-full h-2 mr-2">
                            <div class="bg-green-600 h-2 rounded-full" style="width: ${correctPercentage}%"></div>
                        </div>
                        <span class="text-xs text-gray-600">${correctPercentage.toFixed(1)}% ถูก</span>
                    </div>
                `;
                
                mostCorrectContainer.appendChild(div);
            });
            
            // Display most incorrect questions
            mostIncorrectContainer.innerHTML = '';
            sortedQuestions.slice().reverse().slice(0, 3).forEach((item, index) => {
                const [question, stats] = item;
                const incorrectPercentage = (stats.incorrect / stats.total) * 100;
                
                const div = document.createElement('div');
                div.className = 'p-2 border-b border-green-200 last:border-b-0';
                div.innerHTML = `
                    <p class="font-medium text-sm mb-1">${question}</p>
                    <div class="flex items-center">
                        <div class="w-full bg-gray-200 rounded-full h-2 mr-2">
                            <div class="bg-red-500 h-2 rounded-full" style="width: ${incorrectPercentage}%"></div>
                        </div>
                        <span class="text-xs text-gray-600">${incorrectPercentage.toFixed(1)}% ผิด</span>
                    </div>
                    <p class="text-xs text-green-600 mt-1">คำตอบที่ถูกต้อง: ${stats.correctAnswer}</p>
                `;
                
                mostIncorrectContainer.appendChild(div);
            });
        }

        // Reset quiz
        function resetQuiz() {
            resultsScreen.classList.add('hidden');
            registrationScreen.classList.remove('hidden');
            userNameInput.value = '';
        }

        // Initialize the quiz
        initQuiz();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'93be97e51221d02c',t:'MTc0NjU5ODYzNy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>